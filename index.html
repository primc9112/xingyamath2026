<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>數列探索實驗室 - Sequence Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes bounceIn { 0% { transform: scale(0.9); opacity: 0; } 70% { transform: scale(1.05); } 100% { transform: scale(1); opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .animate-bounce-in { animation: bounceIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .animate-shake { animation: shake 0.2s ease-in-out 0s 2; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // 從全域變數中取出 React Hook
        const { useState, useEffect, useRef } = React;
        
        // 建立 Lucide 圖標組件
        const Icon = ({ name, size = 24, className = "" }) => {
            const [svg, setSvg] = React.useState("");
            React.useEffect(() => {
                const icon = lucide.icons[name];
                if (icon) {
                    const svgString = lucide.createIcons({ icons: { [name]: icon } });
                }
                // 使用原生方式處理 lucide 在瀏覽器端的渲染
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} style={{width: size, height: size}} className={className}></i>;
        };

        // --- 這裡放入你原本的代碼邏輯 ---
        // 注意：這裡我幫你把原本的 <Layers /> 這種寫法改成瀏覽器通用的格式
        
        const SequenceLab = () => {
            const [activeTab, setActiveTab] = useState('arithmetic');
            
            useEffect(() => { lucide.createIcons(); }, [activeTab]);

            return (
                <div className="min-h-screen bg-slate-50 font-sans text-slate-800 selection:bg-blue-200">
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-10 shadow-sm">
                        <div className="max-w-6xl mx-auto px-4 py-4 flex flex-col md:flex-row items-center justify-between gap-4">
                            <div className="flex items-center gap-2">
                                <div className="p-2 bg-blue-600 rounded-lg shadow-lg text-white">
                                    <i data-lucide="calculator"></i>
                                </div>
                                <h1 className="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-700 to-indigo-600">
                                    數列探索實驗室
                                </h1>
                            </div>
                            <nav className="flex p-1 bg-slate-100 rounded-xl">
                                <button onClick={() => setActiveTab('arithmetic')} className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium ${activeTab === 'arithmetic' ? 'bg-white text-blue-600 shadow-md' : 'text-slate-500'}`}>
                                    <i data-lucide="layers" className="w-4 h-4"></i>等差階梯
                                </button>
                                <button onClick={() => setActiveTab('geometric')} className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium ${activeTab === 'geometric' ? 'bg-white text-blue-600 shadow-md' : 'text-slate-500'}`}>
                                    <i data-lucide="trending-up" className="w-4 h-4"></i>等比爆發
                                </button>
                                <button onClick={() => setActiveTab('challenge')} className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium ${activeTab === 'challenge' ? 'bg-white text-blue-600 shadow-md' : 'text-slate-500'}`}>
                                    <i data-lucide="help-circle" className="w-4 h-4"></i>規律挑戰
                                </button>
                            </nav>
                        </div>
                    </header>

                    <main className="max-w-6xl mx-auto px-4 py-8">
                        {activeTab === 'arithmetic' && <ArithmeticMode />}
                        {activeTab === 'geometric' && <GeometricMode />}
                        {activeTab === 'challenge' && <ChallengeMode />}
                    </main>
                </div>
            );
        };

        // ... (這裡補上你原本的 ArithmeticMode, GeometricMode, ChallengeMode 組件內容)
        // 為了簡潔，你需要確保裡面的 <Play /> 改寫為 <i data-lucide="play"></i> 的格式
        
        // 這裡僅示範渲染
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<SequenceLab />);
    </script>
</body>
</html>
